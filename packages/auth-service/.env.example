# ============================================================================
# auth-service — Environment Variables
# ============================================================================
#
# How env vars are loaded depends on context:
#
#   Railway:          Set these per-service in the Railway dashboard.
#                     Use shared variable groups for vars marked [shared].
#   docker-compose:   All vars come from the top-level .env file.
#   pnpm dev:         Loaded from the top-level .env file via pds-core's
#                     dotenv.config() (auth-service runs in the same process
#                     group via pnpm dev).
#
# Vars marked [shared] MUST have the same value in pds-core and auth-service.

# -- Shared with pds-core --

# [shared] Your PDS domain
PDS_HOSTNAME=pds.example

# [shared] Public URL of the PDS (used to build OAuth redirect URLs)
PDS_PUBLIC_URL=https://pds.example

# [shared] HMAC secret for signing /oauth/magic-callback redirects.
# MUST match pds-core. Generate with: openssl rand -hex 32
MAGIC_CALLBACK_SECRET=

# [shared] Secret for internal service-to-service calls (auth → pds).
# MUST match pds-core. Generate with: openssl rand -hex 32
MAGIC_INTERNAL_SECRET=

# [shared] PDS admin password (used for account provisioning via PDS admin API).
# MUST match pds-core. Generate with: openssl rand -hex 32
PDS_ADMIN_PASSWORD=

# [shared] Set to 'development' for dev mode (disables secure cookies, etc.)
# NODE_ENV=development

# -- Auth-service only --

# Subdomain for the auth UI (must be a subdomain of PDS_HOSTNAME)
AUTH_HOSTNAME=auth.pds.example
AUTH_PORT=3001

# Auth service secrets (generate with: openssl rand -hex 32)
AUTH_SESSION_SECRET=
AUTH_CSRF_SECRET=

# Internal URL for reaching pds-core (only needed in Docker where the public
# URL may not be reachable due to hairpin NAT)
# PDS_INTERNAL_URL=http://core:3000

# Magic link settings
MAGIC_LINK_EXPIRY_MINUTES=10
MAGIC_LINK_BASE_URL=https://auth.pds.example/auth/verify

# Better Auth session settings
SESSION_EXPIRES_IN=604800
SESSION_UPDATE_AGE=86400

# Social login providers (both ID and SECRET must be set to enable)
# Google: https://console.cloud.google.com/
# GOOGLE_CLIENT_ID=
# GOOGLE_CLIENT_SECRET=
#
# GitHub: https://github.com/settings/developers
# GITHUB_CLIENT_ID=
# GITHUB_CLIENT_SECRET=

# Email provider: smtp, sendgrid, ses, or postmark
EMAIL_PROVIDER=smtp

# SMTP settings (for EMAIL_PROVIDER=smtp, or as overrides for other providers)
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USER=
SMTP_PASS=

# SendGrid (EMAIL_PROVIDER=sendgrid)
# SENDGRID_API_KEY=SG.xxxxx

# AWS SES SMTP (EMAIL_PROVIDER=ses)
# AWS_REGION=us-east-1
# AWS_SES_SMTP_USER=
# AWS_SES_SMTP_PASS=

# Postmark (EMAIL_PROVIDER=postmark)
# POSTMARK_SERVER_TOKEN=

# Sender address and name
SMTP_FROM=noreply@pds.example
SMTP_FROM_NAME=ePDS

# Database path (separate from PDS account.sqlite)
DB_LOCATION=/data/epds.sqlite
